/*
 * filter.c
 *
 *  Created on: 2017年12月6日
 *      Author: Administrator
 */
#include "fdacoefs.h"

#include <stdio.h>

const double coe[257] = {
    0.03888819728987, 0.001570613126707, 0.001600049922153, 0.001633987264646,
   0.001663801970842, 0.001698270240762, 0.001728301162238, 0.001763265035634,
   0.001793922820102, 0.001829408679952, 0.001860370822006, 0.001896017025802,
   0.001926936485738, 0.001962735203867, 0.001993746529479, 0.002029964120213,
    0.00206068884701, 0.002096404062311, 0.002126339830774, 0.002161419928648,
   0.002193284843969, 0.002226348287243, 0.002256658747431, 0.002291691021169,
   0.002321779237153, 0.002357133002929, 0.002386840226722,  0.00242311440513,
    0.00245383633519, 0.002491885326543, 0.002523588262803, 0.002563109301689,
   0.002594792048522, 0.002634910547126, 0.002664396656644, 0.002703024547605,
   0.002725274079737, 0.002759026549419, 0.002766759162667, 0.002815221726073,
   0.002885228268844, 0.002881474318922, 0.002927669315656, 0.002953942515708,
   0.002991573353874, 0.003021009194446,  0.00305597270216, 0.003086523959506,
   0.003120242210467, 0.003151298530238, 0.003183967164424, 0.003214915025576,
   0.003246393528612, 0.003277086080863, 0.003307726937943, 0.003338782386056,
   0.003368583095013, 0.003399776767667, 0.003427978057479, 0.003459055520421,
   0.003489904761645, 0.003518029507003,  0.00354764698545,  0.00357723893484,
    0.00360650101811, 0.003635483814689, 0.003662745471724, 0.003690501222897,
   0.003716433033434, 0.003743532287322, 0.003768562531177, 0.003795411253733,
   0.003820109779744, 0.003847790721333, 0.003873007522423, 0.003902089740987,
   0.003925306528261, 0.003951371610388, 0.003963956422755, 0.003995990224455,
   0.004023013014049, 0.004039749954913, 0.004065639402161, 0.004085596365986,
   0.004108789418974, 0.004128830245049, 0.004150229455565, 0.004169876658734,
   0.004190255510213, 0.004209614300404, 0.004229189857342,   0.0042480016325,
   0.004266530453115, 0.004284549983447, 0.004302077760403, 0.004319808680772,
   0.004335998507067, 0.004353776922592, 0.004366039141855, 0.004383992272013,
   0.004398794145431, 0.004411339422689, 0.004424476955498, 0.004437637336142,
   0.004451071959067, 0.004463871948729, 0.004475870363307, 0.004487486198495,
   0.004498269926704, 0.004508929443013,  0.00451849353309,  0.00452779051265,
   0.004535817703034, 0.004544008833016,   0.0045516265304, 0.004560501384607,
   0.004567643110308, 0.004574370098222, 0.004573826407593, 0.004584211881435,
   0.004587584683122, 0.004590932655308, 0.004594966962624,  0.00459774162305,
   0.004600818313973,   0.0046026934787, 0.004604305716383, 0.004604982451836,
   0.004605372737762, 0.004604982451836, 0.004604305716383,   0.0046026934787,
   0.004600818313973,  0.00459774162305, 0.004594966962624, 0.004590932655308,
   0.004587584683122, 0.004584211881435, 0.004573826407593, 0.004574370098222,
   0.004567643110308, 0.004560501384607,   0.0045516265304, 0.004544008833016,
   0.004535817703034,  0.00452779051265,  0.00451849353309, 0.004508929443013,
   0.004498269926704, 0.004487486198495, 0.004475870363307, 0.004463871948729,
   0.004451071959067, 0.004437637336142, 0.004424476955498, 0.004411339422689,
   0.004398794145431, 0.004383992272013, 0.004366039141855, 0.004353776922592,
   0.004335998507067, 0.004319808680772, 0.004302077760403, 0.004284549983447,
   0.004266530453115,   0.0042480016325, 0.004229189857342, 0.004209614300404,
   0.004190255510213, 0.004169876658734, 0.004150229455565, 0.004128830245049,
   0.004108789418974, 0.004085596365986, 0.004065639402161, 0.004039749954913,
   0.004023013014049, 0.003995990224455, 0.003963956422755, 0.003951371610388,
   0.003925306528261, 0.003902089740987, 0.003873007522423, 0.003847790721333,
   0.003820109779744, 0.003795411253733, 0.003768562531177, 0.003743532287322,
   0.003716433033434, 0.003690501222897, 0.003662745471724, 0.003635483814689,
    0.00360650101811,  0.00357723893484,  0.00354764698545, 0.003518029507003,
   0.003489904761645, 0.003459055520421, 0.003427978057479, 0.003399776767667,
   0.003368583095013, 0.003338782386056, 0.003307726937943, 0.003277086080863,
   0.003246393528612, 0.003214915025576, 0.003183967164424, 0.003151298530238,
   0.003120242210467, 0.003086523959506,  0.00305597270216, 0.003021009194446,
   0.002991573353874, 0.002953942515708, 0.002927669315656, 0.002881474318922,
   0.002885228268844, 0.002815221726073, 0.002766759162667, 0.002759026549419,
   0.002725274079737, 0.002703024547605, 0.002664396656644, 0.002634910547126,
   0.002594792048522, 0.002563109301689, 0.002523588262803, 0.002491885326543,
    0.00245383633519,  0.00242311440513, 0.002386840226722, 0.002357133002929,
   0.002321779237153, 0.002291691021169, 0.002256658747431, 0.002226348287243,
   0.002193284843969, 0.002161419928648, 0.002126339830774, 0.002096404062311,
    0.00206068884701, 0.002029964120213, 0.001993746529479, 0.001962735203867,
   0.001926936485738, 0.001896017025802, 0.001860370822006, 0.001829408679952,
   0.001793922820102, 0.001763265035634, 0.001728301162238, 0.001698270240762,
   0.001663801970842, 0.001633987264646, 0.001600049922153, 0.001570613126707,
    0.03888819728987
};


const double coe_B[257] = {
     -0.111443479469,   0.1816775710627,   0.0875250676484,  0.04303797356192,
    0.02201431120307,  0.01208485717306, 0.007375434540862, 0.005132872386952,
   0.004052951024237, 0.003517887971449, 0.003216577541263, 0.003030123697201,
    0.00289512649155, 0.002780860822646, 0.002651097475854, 0.002524775350538,
   0.002387399889115,  0.00224659118041, 0.002083775526996, 0.001928072227926,
   0.001747099864521, 0.001571239634772, 0.001381078651736, 0.001190975986959,
  0.0009875469604449,0.0007845608599293,0.0005627055190606,0.0003359437744537,
  0.0001035550335219,-0.0001219494950106,-0.0003577513208634,-0.0005823354630277,
  -0.0008298931226952,-0.001059273295112,-0.001298604915022,-0.001523941738742,
   -0.00175751473048,-0.001988262269323,-0.002217578791198,-0.002438541071298,
  -0.002653882076724,-0.002857873595745,-0.003071226675026,-0.003258733173466,
  -0.003447612138696, -0.00360408091131, -0.00377405872734,-0.003910787216009,
  -0.004071379423788,-0.004179210734081,-0.004315008901534,-0.004387738267013,
  -0.004507199685474,-0.004543285838155,-0.004584447567647,-0.004669057955129,
  -0.004555399423756,-0.004744218016404,-0.004539237286939,-0.004578667792206,
  -0.004588228952869,-0.004428631041483,-0.004291678028342,-0.004277519276607,
  -0.004107983440417,-0.003885402937315,-0.003722134087446,-0.003606346374045,
  -0.003360641954164,-0.003063989616438,-0.002796260993221,-0.002590095170179,
   -0.00230025606064,-0.001945331472254,-0.001571838933007,-0.001255736417653,
  -0.0009114660721611,-0.000540014563905,-0.0001030116939427,0.0003494436545685,
  0.0007962756734589, 0.001198138189819, 0.001633230060619, 0.002102643666782,
   0.002620599842692, 0.003150859490574, 0.003677547479877, 0.004155532511191,
    0.00466838571539, 0.005171433983984, 0.005733601048721, 0.006303562827902,
    0.00687259492585, 0.007426933337792, 0.007954307446788, 0.008485145736058,
   0.009023635176284, 0.009582619611035,  0.01015354343926,  0.01071110441483,
     0.0112635465303,  0.01179182163168,  0.01231861543369,  0.01281529822941,
    0.01331654592904,  0.01378465982421,  0.01428321099583,  0.01475563900971,
    0.01525654958942,  0.01570146480221,  0.01613111847203,  0.01654238757354,
    0.01689686218773,  0.01730486183556,  0.01761614014267,   0.0179476199449,
    0.01825538153378,  0.01853363790114,  0.01882279226922,  0.01908532790454,
    0.01927494427516,  0.01947585969414,  0.01967167915558,  0.01979967827634,
    0.01987892426303,  0.01997684981407,  0.02004742966966,  0.02006411011052,
    0.02005317169104,  0.02006411011052,  0.02004742966966,  0.01997684981407,
    0.01987892426303,  0.01979967827634,  0.01967167915558,  0.01947585969414,
    0.01927494427516,  0.01908532790454,  0.01882279226922,  0.01853363790114,
    0.01825538153378,   0.0179476199449,  0.01761614014267,  0.01730486183556,
    0.01689686218773,  0.01654238757354,  0.01613111847203,  0.01570146480221,
    0.01525654958942,  0.01475563900971,  0.01428321099583,  0.01378465982421,
    0.01331654592904,  0.01281529822941,  0.01231861543369,  0.01179182163168,
     0.0112635465303,  0.01071110441483,  0.01015354343926, 0.009582619611035,
   0.009023635176284, 0.008485145736058, 0.007954307446788, 0.007426933337792,
    0.00687259492585, 0.006303562827902, 0.005733601048721, 0.005171433983984,
    0.00466838571539, 0.004155532511191, 0.003677547479877, 0.003150859490574,
   0.002620599842692, 0.002102643666782, 0.001633230060619, 0.001198138189819,
  0.0007962756734589,0.0003494436545685,-0.0001030116939427,-0.000540014563905,
  -0.0009114660721611,-0.001255736417653,-0.001571838933007,-0.001945331472254,
   -0.00230025606064,-0.002590095170179,-0.002796260993221,-0.003063989616438,
  -0.003360641954164,-0.003606346374045,-0.003722134087446,-0.003885402937315,
  -0.004107983440417,-0.004277519276607,-0.004291678028342,-0.004428631041483,
  -0.004588228952869,-0.004578667792206,-0.004539237286939,-0.004744218016404,
  -0.004555399423756,-0.004669057955129,-0.004584447567647,-0.004543285838155,
  -0.004507199685474,-0.004387738267013,-0.004315008901534,-0.004179210734081,
  -0.004071379423788,-0.003910787216009, -0.00377405872734, -0.00360408091131,
  -0.003447612138696,-0.003258733173466,-0.003071226675026,-0.002857873595745,
  -0.002653882076724,-0.002438541071298,-0.002217578791198,-0.001988262269323,
   -0.00175751473048,-0.001523941738742,-0.001298604915022,-0.001059273295112,
  -0.0008298931226952,-0.0005823354630277,-0.0003577513208634,-0.0001219494950106,
  0.0001035550335219,0.0003359437744537,0.0005627055190606,0.0007845608599293,
  0.0009875469604449, 0.001190975986959, 0.001381078651736, 0.001571239634772,
   0.001747099864521, 0.001928072227926, 0.002083775526996,  0.00224659118041,
   0.002387399889115, 0.002524775350538, 0.002651097475854, 0.002780860822646,
    0.00289512649155, 0.003030123697201, 0.003216577541263, 0.003517887971449,
   0.004052951024237, 0.005132872386952, 0.007375434540862,  0.01208485717306,
    0.02201431120307,  0.04303797356192,   0.0875250676484,   0.1816775710627,
     -0.111443479469
};



int filter(u32 *indata,u32 *outdata) /*FIR低通滤波子程序*/
{
	int i,j;
	double sum;

	for(i = 0 ;i < LF_DATA_SIZE ;i++)
	{
		sum = 0;
		for(j = 0 ;j < ORDER ;j++) /*卷积运算*/
		{
			sum += (double)coe[j] * indata[i-j+ORDER-1];
		}
		outdata[i]=(u32)sum; /*计算输出，去掉所称倍数*/
	}
	return 1;
}





/*
 *
 * www.osrc.cn
 * www.milinker.com
 * copyright by nan jin mi lian dian zi www.osrc.cn
*/

#ifndef TIMER_INTR_H_
#define TIMER_INTR_H_

#include <stdio.h>
#include "xadcps.h"
#include "xil_types.h"
#include "Xscugic.h"
#include "Xil_exception.h"
#include "xscutimer.h"
#include "xil_printf.h"
#include "xadc_dev.h"
#include "gpio_dev.h"

#define TIMER_2MS7
#define TIMER_2S      72000
#define TIMER_250MS   9000
#define LF_DATA_SIZE  (720*2)
#define SYN_PERIOD    (36000*60*10)

#define MAX(a,b)     (((a)>(b))?(a):(b))
#define MIN(a,b)     (((a)<(b))?(a):(b))

extern int TcpTmrFlag;
extern u32 tmr_2s_flag_cnt;
extern u32 tmr_2s_flag;
extern u32 tmr_2ms7_flag;
extern int syn_flag;
extern u32 syn_cnt;
extern u16 peak_cnt1;
extern u32 lf_peak_tmp;
extern u32 lf_data[LF_DATA_SIZE];
extern u32 phase_buf[21];
//timer info
#define TIMER_DEVICE_ID     XPAR_XSCUTIMER_0_DEVICE_ID
#define TIMER_IRPT_INTR     XPAR_SCUTIMER_INTR

void Timer_start(XScuTimer *TimerPtr);
void Timer_Setup_Intr_System(XScuGic *GicInstancePtr,XScuTimer *TimerInstancePtr, u16 TimerIntrId);
int Timer_init(XScuTimer *TimerPtr,u32 Load_Value,u32 DeviceId);
extern u32 FindMax(u32 *arr);
extern u16 GetPhasePos(void);
extern void GetLFData(u32 *arr);
#endif /* TIMER_INTR_H_ */
